      </div>
    </main>

    <!-- Right TOC -->
    <aside class="toc">
      <div class="toc-title">On this page</div>
    </aside>
  </div> <!-- layout -->

  <script>
    // Theme toggle functionality
    function toggleTheme() {
      const html = document.documentElement;
      const currentTheme = html.getAttribute('data-theme');
      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
      html.setAttribute('data-theme', newTheme);
    }

    // Mobile sidebar toggle
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('open');
    }

    // Update table of contents
    function updateTOC() {
      const content = document.getElementById('content');
      const headings = content.querySelectorAll('h2, h3');
      const toc = document.querySelector('.toc');
      
      // Clear existing TOC items except title
      const tocItems = toc.querySelectorAll('.toc-item');
      tocItems.forEach(item => item.remove());
      
      // Add new TOC items
      headings.forEach(heading => {
        const link = document.createElement('a');
        link.href = heading.baseURI
        link.className = `toc-item ${heading.tagName === 'H3' ? 'level-2' : ''}`;
        link.textContent = heading.textContent;
        toc.appendChild(link);
      });
    }

    updateTOC();

    // Initialize TOC highlighting on scroll
    // TODO this does not yet work
    window.addEventListener('scroll', () => {
      const headings = document.querySelectorAll('h1, h2, h3');
      const tocItems = document.querySelectorAll('.toc-item');
      
      let current = '';
      headings.forEach(heading => {
        const rect = heading.getBoundingClientRect();
        if (rect.top <= 100) {
          current = heading.id;
        }
      });
      
      tocItems.forEach(item => {
        item.classList.remove('active');
        if (item.getAttribute('href') === `#${current}`) {
          item.classList.add('active');
        }
      });
    });

    // Close mobile sidebar on content click
    document.addEventListener('click', (e) => {
      const sidebar = document.getElementById('sidebar');
      if (window.innerWidth <= 768 && !sidebar.contains(e.target) && !e.target.classList.contains('mobile-menu-btn')) {
        sidebar.classList.remove('open');
      }
    });
  </script>
</body>
</html>
